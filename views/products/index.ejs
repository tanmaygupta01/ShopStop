<%- layout('./layouts/boilerplate') %>


    <div class="row mt-5" style="margin: 80px 10px !important;">
        <div class="col-lg-10 mx-auto">
            <%- include('../partials/flash.ejs') %>
        </div>
        <div class="col-lg-9 mx-auto">
            <div id="carouselExampleSlidesOnly" class="carousel slide carousel-fade" data-bs-ride="carousel" style="margin-top: 50px;">
                <div class="carousel-inner" style="cursor: pointer;">
                    <div class="carousel-item active">
                        <img src="https://s3.envato.com/files/260793076/07.png" class="d-block w-100 carousel-images ">
                    </div>
                    <div class="carousel-item">
                        <img src="https://iwishgenie.com/wp-content/uploads/2021/06/trendy-apparel-kids-slider-3.jpg" class="d-block w-100 carousel-images">
                    </div>
                    <div class="carousel-item">
                        <img src="https://prod-img.thesouledstore.com/public/theSoul/uploads/slider/20220530184019.jpg?format=webp&w=1440&dpr=1.0" class="d-block w-100 carousel-images">
                    </div>
                    <div class="carousel-item">
                        <img src="https://athlosstcloud.org/wp-content/uploads/2018/12/blog_header-801x321.jpg" class="d-block w-100 carousel-images">
                    </div>
                    <div class="carousel-item">
                        <img src="https://store.sscnapoli.it/img/sales_eng_628f79159b7c6.jpg" class="d-block w-100 carousel-images">
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 my-4">
            <h2 class="text-center headings ">Tech Store</h2>
        </div>
        <%for(let product of products){%>
            <%if(product.category === 'gadget'){%>
                <div class="col-xl-3 col-md-6 mb-5">
                    <div class="card scalecard p-2 mx-auto" style="width: 21rem;">
                        <img src="<%=product.image%>" class="card-img-top mt-3 text-center product-images" style="height: 180px; width: 180px; margin-left: 70px;">
                        <div class="card-body mt-2">
                            <a href="/products/<%=product._id%>" class="text-decoration-none">
                                <h5 class="card-title underline">
                                    <%=product.name.substring(0,40)%>...</h5>
                            </a>
                            <p class="card-text desc">
                                <%=product.desc.substring(0,40)%>...</p>
                            <p class="card-text new-price fw-bold d-inline">
                                <%=product.newPrice.toLocaleString('en-IN', { style: 'currency', currency: 'INR'})%>/-</p>
                            <p class="card-text text-decoration-line-through text-muted d-inline mx-1">
                                <%=product.oldPrice.toLocaleString('en-IN', { style: 'currency', currency: 'INR'})%>/-</p>
                            <p class="card-text discount d-inline">(
                                <%=product.discount%>% OFF)</p>
                            <%if(product.reviews.length === 0){%>
                                <p class="card-text text-muted mt-1">No reviews</p>
                                <%}%>
                                    <%if(product.reviews.length === 1){%>
                                        <p class="card-text text-muted mt-1">1 review</p>
                                        <%}%>
                                            <%if(product.reviews.length > 1){%>
                                                <p class="card-text text-muted mt-1">
                                                    <%=product.reviews.length%> reviews</p>
                                                <%}%>
                        </div>
                        <div class="card-body d-flex justify-content-between align-items-center" style="margin-top: -10px;">
                            <%if(currentUser && product.author.equals(currentUser._id)){%>
                                <a href="/products/<%=product._id%>" class="btn index-button">Edit</a>
                                <span class="btn like-btn highlight" product-id="<%=product._id%>">
                            <%}%>
                            
                            <%if(currentUser && !product.author.equals(currentUser._id)){%>
                                <a href="/products/<%=product._id%>" class="btn index-button">Buy Now</a>
                                <span class="btn like-btn highlight" product-id="<%=product._id%>">
                            <%}%>

                        <%if(currentUser && currentUser.wishList.includes(product._id)){%>
                            <i class="fas fa-heart"></i>
                        <%}else{%>
                            <i class="far fa-heart"></i>
                        <%}%>
                    </span>
                        </div>
                    </div>
                </div>
                <%}%>
                    <%}%>
                        <div class="col-lg-12 my-4">
                            <h2 class="text-center headings">Clothes & Apparel</h2>
                        </div>
                        <%for(let product of products){%>
                            <%if(product.category === 'fashion'){%>
                                <div class="col-xl-3 col-md-6 mb-5">
                                    <div class="card scalecard p-2 mx-auto" style="width: 21rem;">
                                        <img src="<%=product.image%>" class="card-img-top mt-3 text-center product-images" style="height: 180px; width: 180px; margin-left: 70px;">
                                        <div class="card-body mt-2">
                                            <a href="/products/<%=product._id%>" class="text-decoration-none">
                                                <h5 class="card-title underline">
                                                    <%=product.name.substring(0,40)%>...</h5>
                                            </a>
                                            <p class="card-text desc">
                                                <%=product.desc.substring(0,40)%>...</p>
                                            <p class="card-text new-price fw-bold d-inline">
                                                <%=product.newPrice.toLocaleString('en-IN', { style: 'currency', currency: 'INR'})%>/-</p>
                                            <p class="card-text text-decoration-line-through text-muted d-inline mx-1">
                                                <%=product.oldPrice.toLocaleString('en-IN', { style: 'currency', currency: 'INR'})%>/-</p>
                                            <p class="card-text discount d-inline">(
                                                <%=product.discount%>% OFF)</p>
                                            <%if(product.reviews.length === 0){%>
                                                <p class="card-text text-muted mt-1">No reviews</p>
                                                <%}%>
                                                    <%if(product.reviews.length === 1){%>
                                                        <p class="card-text text-muted mt-1">1 review</p>
                                                        <%}%>
                                                            <%if(product.reviews.length > 1){%>
                                                                <p class="card-text text-muted mt-1">
                                                                    <%=product.reviews.length%> reviews</p>
                                                                <%}%>
                                        </div>
                                        <div class="card-body" style="margin-top: -10px;">
                                            <%if(currentUser && product.author.equals(currentUser._id)){%>
                                                <a href="/products/<%=product._id%>" class="btn index-button">Edit</a>
                                                <span class="btn like-btn highlight" product-id="<%=product._id%>">
                                            <%}%>
                                            <%if(currentUser && !product.author.equals(currentUser._id)){%>
                                                <a href="/products/<%=product._id%>" class="btn index-button">Buy Now</a>
                                                <span class="btn like-btn highlight" product-id="<%=product._id%>">
                                            <%}%>
                        <%if(currentUser && currentUser.wishList.includes(product._id)){%>
                            <i class="fas fa-heart"></i>
                        <%}else{%>
                            <i class="far fa-heart"></i>
                        <%}%>
                    </span>
                                        </div>
                                    </div>
                                </div>
                                <%}%>
                                    <%}%>
                                        <div class="col-lg-12 my-4">
                                            <h2 class="text-center headings">Hot Deals</h2>
                                        </div>
                                        <%for(let product of products){%>
                                            <%if(product.category === 'accessory'){%>
                                                <div class="col-xl-3 col-md-6 mb-5">
                                                    <div class="card scalecard p-2 mx-auto" style="width: 21rem;">
                                                        <img src="<%=product.image%>" class="card-img-top mt-3 text-center product-images" style="height: 180px; width: 180px; margin-left: 70px;">
                                                        <div class="card-body mt-2">
                                                            <a href="/products/<%=product._id%>" class="text-decoration-none">
                                                                <h5 class="card-title underline">
                                                                    <%=product.name.substring(0,40)%>...</h5>
                                                            </a>
                                                            <p class="card-text desc">
                                                                <%=product.desc.substring(0,40)%>...</p>
                                                            <p class="card-text new-price fw-bold d-inline">
                                                                <%=product.newPrice.toLocaleString('en-IN', { style: 'currency', currency: 'INR'})%>/-</p>
                                                            <p class="card-text text-decoration-line-through text-muted d-inline mx-1">
                                                                <%=product.oldPrice.toLocaleString('en-IN', { style: 'currency', currency: 'INR'})%>/-</p>
                                                            <p class="card-text discount d-inline">(
                                                                <%=product.discount%>% OFF)</p>
                                                            <%if(product.reviews.length === 0){%>
                                                                <p class="card-text text-muted mt-1">No reviews</p>
                                                                <%}%>
                                                                    <%if(product.reviews.length === 1){%>
                                                                        <p class="card-text text-muted mt-1">1 review</p>
                                                                        <%}%>
                                                                            <%if(product.reviews.length > 1){%>
                                                                                <p class="card-text text-muted mt-1">
                                                                                    <%=product.reviews.length%> reviews</p>
                                                                                <%}%>
                                                        </div>
                                                        <div class="card-body" style="margin-top: -10px;">
                                                            <%if(currentUser && product.author.equals(currentUser._id)){%>
                                                                <a href="/products/<%=product._id%>" class="btn index-button">Edit</a>
                                                                <span class="btn like-btn highlight" product-id="<%=product._id%>">
                                                            <%}%>
                                                            <%if(currentUser && !product.author.equals(currentUser._id)){%>
                                                                <a href="/products/<%=product._id%>" class="btn index-button">Buy Now</a>
                                                                <span class="btn like-btn highlight" product-id="<%=product._id%>">
                                                            <%}%>
                        <%if(currentUser && currentUser.wishList.includes(product._id)){%>
                            <i class="fas fa-heart"></i>
                        <%}else{%>
                            <i class="far fa-heart"></i>
                        <%}%>
                    </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <%}%>
                                                    <%}%>
    </div>


    <script src="/js/wishList.js"></script>